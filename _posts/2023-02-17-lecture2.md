---
title: Доказательство теоремы Липтона--Тарьяна + обсуждение теоремы Кёбе
permalink: lecture2
---

+ [<mark>Видео</mark>](https://drive.google.com/file/d/1jJeeImW5AalZdrlOjC12rS5cAM1UrwWk/view?usp=sharing)
+ [<mark>Доска</mark>]({{site.baseurl}}/whiteboard/lec2.pdf)


## Доказательство теоремы Липтона--Тарьяна

Напомню, что мы доказываем вот такую теорему о разрезании планарного графа на не очень большие куски.

> **Теорема [Lipton--Tarjan, 1979].** Любой планарный граф $G = (V,E)$ на $n$ вершинах содержит множество $S \subset V$ размера $\|S\| < 2\sqrt{n}$, такое что любая связная компонента дополнения $G \setminus S$ содержит не более $3n/4$ вершин. 

_Доказательство **[Miller--Teng--Thurston--Vavasis, 1979]**._

По теореме Кёбе (см. сильную формулировку ниже) граф $G$ можно реализовать на сфере системой неперекрывающихся сферических шапочек $C_i$ внутри сферы единичного радиуса $S^2 \subset \mathbb{R}^3$; шапочки представляют вершины графа, а касания --- рёбра. Реализация не единственна; например, можно применить ко всей сфере _преобразование Мёбиуса_, то есть преобразование, сохраняющее окружности и углы. Главный для нас пример преобразований Мёбиуса устроен так. Нужно взять пару антиподальных точек $n,s \in S^2$ ("северный и южный полюса"), нарисовать касательную плоскость $L$ к сфере в точке $s$, а затем рассмотреть композицию следующих трёх отображений: (1) стереографическая проекция сферы $S$ из точки $n$ на плоскость $L$; (2) гомотетия (растяжение/сжатие) плоскости $L$ относительно $s$ с произвольным положительным коэффициентом $\lambda$; (3) обратная стереографическая проекция с плоскости $L$ на сферу $S^2$ (с центром проекции $n$). Каждой точке $x$ из внутренности единичного шара $B^3$ (ограниченного сферой $S^2$) сопоставим преобразование Мёбиуса $\tau_x$ по следующему правилу: если $x$ --- центр шара, положим $\tau_x = \text{id}$; если $x$ отлична от центра шара, рассмотрим проекцию точки $x$ на сферу $S^2$, то есть $x' = \frac{x}{\|x\|}$, и положим $\tau_x$ равным преобразованию Мёбиуса, описанному выше, с выбором южного полюса $s = x'$ и коэффициентом гомотетии $\lambda = 1-\|x\|$. Грубо говоря, чем ближе $x$ к сфере $S^2$, тем сильнее $\tau_x$ сжимает сферу в сторону точки $x'$.

На наше представление графа шапочками можно подействовать преобразованием $\tau_x$ и получить другое представление шапочками. Покажем, что из топологических соображений можно подобрать удачное преобразование Мёбиуса, которое сделает наше представление графа достаточно "равномерно распределённым" по сфере.
Для любого представления сферическими шапочками отметим на сфере их центры и рассмотрим множество всех "медиан" центров. Напомню, что медиана облака точек в $\mathbb{R}^3$ обладает тем свойством, что любая плоскость через неё делит облако на множества размера не более 75%. Медиана всегда существует (теорема Радо). Рассмотрим следующее отображение из внутренности единичного шара $B^3$ (ограниченного сферой $S^2$). 

$$
f: x \in B^3 \setminus S^2 \mapsto \text{медиана множества центров шапочек } \tau_x(C_i).
$$

Представим на секунду, что отображение $f$ обладает дополнительными двумя свойствами:
1. оно непрерывно и может быть продолжено на границу;
2. его продолжение фиксирует сферу: $f(x) = x$ для любой точки $x \in S^2$.

Вообще говоря, эти свойства не выполняются, но в задачах будет обсуждение, как этот аргумент починить. Выполнения первого свойства можно добиться, аккуратно выбирая медианы. Второе свойство, например, выполнено, если антипод точки $x'$ не принадлежит ни одной шапочке $C_i$, но в общем случае нужно действовать аккуратней. Тем не менее, если бы эти свойства были выполнены, то мы бы применили топологическую теорему о степени отображения, которая бы гарантировала нам, что существует $x \in B^3\setminus S^2$ такое, что $f(x) = 0$ (центр шара $B^3$). Подробности этого рассуждения см. в [задаче 1]({{site.baseurl}}/problems#шевеление-медианы). 

Итак, пусть мы добились (применяя подходящее преобразование Мёбиуса) того, что центр шара является медианой системы центров сферических шапочек $C_i$, реализующих наш граф $G$. Выберем случайную плоскость $H$ через центр шара. Пусть $S \subset V$ соответствует тем шапочкам, которые пересекают $H$. Мы подсчитаем матожидание мощности $S$ и оно окажется меньше $2\sqrt{n}$. Поэтому существует подходящая плоскость $H$, которая и укажет нам, как разрезать граф $G$. Пусть $\rho_i$ --- сферический (угловой) радиус шапочки $C_i$. Мы воспользуемся элементарным неравенством $\sin \rho_i < 2 \sin (\rho_i/2)$, формулой Архимеда для площадей на сфере, а так же линейностью матожидания, которая говорит нам, что $\mathbb{E}(\\#i: C_i \cap H \neq \varnothing) = \sum\limits_i \text{Prob}(C_i \cap H \neq \varnothing)$. Вероятность пересечения отдельной шапочки равна

$$
\text{Prob}(C_i \cap H \neq \varnothing) = \frac{\text{Area }W_{\rho_i} }{\text{Area }S^2} = \frac{4\pi \sin \rho_i}{4\pi} = \sin \rho_i,
$$

где через $W_{\rho_i}$ обозначен сферический поясок угловой полуширины $\rho_i$. 
Суммируя по всем шапочкам, получаем:

$$
\begin{align*}
\mathbb{E}(\#i: C_i \cap H \neq \varnothing) &= \sum_i \sin \rho_i \\
&\le \sqrt{n} \left( \sum_i (\sin \rho_i)^2 \right)^{1/2} \\
&< 2 \sqrt{n} \left( \sum_i \left(\sin \frac{\rho_i}{2}\right)^2 \right)^{1/2} \\
&< 2\sqrt{n}.
\end{align*}
$$

Здесь мы использовали неравенство Коши--Буняковского, а также тот факт, что сумма площадей шапочек меньше площади сферы: $\sum\limits_i 4\pi(\sin \frac{\rho_i}{2})^2 < 4\pi$. 
\\(\square\\)
 


## Обсуждение теоремы Кёбе

Планарный граф называется _трёхсвязным_, если он представляет собой скелет какого-то трёхмерного многогранника (то есть у этого многогранника вершины и рёбра образуют такой же граф). Мы докажем, что любой планарный трёхсвязный граф можно реализовать касаниями дисков на плоскости, и из этого будет следовать, что любой планарный граф тоже можно ([задача 2]({{site.baseurl}}/problems#трёхсвязные-графы)).

Для планарного трёхсвязного графа $G = (V,E)$ канонически определён двойственный граф $G^\* = (V^\*, E^\*)$, так как любые два способа нарисовать $G$ по сути эквивалентны ([задача 2]({{site.baseurl}}/problems#трёхсвязные-графы)). Для данной плоской рисовки графа $G$ вершинами двойственного графа являются грани (страны) рисовки графа $G$, включая внешнюю грань $p_{ext} \in V^\*$, и две грани соединены ребром в $G^\*$, если они смежны по ребру графа $G$.

_Двойным представлением кругами_ данного планарного трёхсвязного графа $G = (V,E)$ назовём следующий набор данных. Во-первых, это семейство неперекрывающихся кругов $C_i$, $i \in V$. Во-вторых, это семейство неперекрывающихся кругов $D_p$, $p \in V^\* \setminus p_{ext}$, плюс неперекрывающееся с ними множество $D_{p_{ext}}$, которое есть внешность круга; удобно думать про $D_{p_{ext}}$ тоже как про круг, просто "внешний", или проходящий через бесконечно удалённую точку (подумайте об этом в терминах стереографической проекции). Круги должны удовлетворять следующим свойствам:

+ для любого ребра $ij \in E$ круги $C_i$ и $C_j$ касаются в точке $x_{ij}$ (и не касаются, если  $ij \notin E$);

+ для любого двойственного ребра $pq \in E^\*$ "круги" $D_p$ и $D_q$ касаются в точке $x_{ij}$, где $ij \in E$ --- общее ребро граней $p, q$ (и, аналогично, $D_p$ и $D_q$ не касаются, если $pq \notin E^\*$);

+ для любой инцидентной пары $i \in V, p \in V^\*$ граничные окружности $C_i$ и $D_p$ пересекаются ортогонально.

> **Теорема [Koebe, 1936].** Любой планарный трёхсвязный граф $G = (V,E)$ допускает двойное представление кругами. 

Смысл такого усиления (по сравнению с формулировкой, использованной нами в доказательстве теоремы Липтона--Тарьяна) в том, что оно делает представление Кёбе почти единственным (с точностью до преобразований Мёбиуса), и доказать существование такого жёсткого объекта становится проще.

<p align="center">
<img src="{{site.baseurl}}/images/lec2koe.jpg" alt="Двойное представление кругами" title="Рисунок:  L. Lovász>" width="490">
</p>

Пусть $U = V \cup (V^\* \setminus P_{ext})$, и каждому $u \in U$ сопоставим соответствующий радиус круга $r_u$ в искомом двойном представлении. Тогда углы

$$
\begin{equation}
    \alpha_{ip} = \arctg \frac{r_p}{r_i}, \quad \alpha_{pi} = \arctg \frac{r_i}{r_p} = \frac{\pi}{2} - \alpha_{ip} \tag{$\star$}
\end{equation}
$$

удовлетворяют естественным линейным соотношениям типа

$$
\begin{equation}
\forall p \in V^* \setminus P_{ext}: \quad \sum_{i \text{ инцид. } p} \alpha_{pi} = \pi, \tag{$\heartsuit$}
\end{equation}
$$

которые легко увидеть на картинке, суммируя углы вокруг центра круга $D_p$ (соотношения для $C_i$ аналогичны).

_Набросок неправильного доказательства теоремы Кёбе._

Попробуем подобрать числа $r_u$, чтобы для определяемых формулами $(\star)$ углов выполнялись соотношения типа $(\heartsuit)$. Тогда из кругов соответствующих радиусов можно будет собрать двойное представление. Для начала возьмём положительные числа $r_u$ от фонаря, и спросим, насколько соотношения $(\heartsuit)$ далеки от правды. Если они ещё не выполнены, то всегда можно немножко увеличить или уменьшить какой-то радиус $r_u$ (или несколько радиусов), чтобы соотношения $(\heartsuit)$ стали немножко ближе к правде. Продолжая в таком духе, мы в пределе найдём представление Кёбе.
\\(\square\\)

Проблема этого рассуждения в том, что пространство радиусов $r: U \to (0,+\infty)$ отнюдь не компактно, и продолжая в том же духе, мы можем никуда и не сойтись.
Правильное доказательство будет дано в следующей лекции.

## Cсылки
+ P. Koebe, [Kontaktprobleme der konformen Abbildung], _Berichte über die Verhandlungen Sächs, Akad. Wiss., Math.–Phys. Klasse_ (1936).
+ L. Lovász, [Graphs and Geometry](http://web.cs.elte.hu/~lovasz/bookxx/geomgraphbook/geombook2019.01.11.pdf). _American Mathematical Society_ (2019). Chapter 5:  Coin representation.