I"Ö<ul>
  <li><a href="https://drive.google.com/file/d/1B6dCC30InHXP04sOaz8gXc6RbwyFdnbt/view?usp=sharing"><mark>Ğ’Ğ¸Ğ´ĞµĞ¾</mark></a></li>
  <li><a href="/mipt2023systolic/whiteboard/lec11.pdf"><mark>Ğ”Ğ¾ÑĞºĞ°</mark></a></li>
</ul>

<p>$\sum_i x_i = 1$</p>

\[\sum_i x_i = 1\]

<h2 id="Ñ‚ĞµĞ·Ğ¸ÑÑ‹">â€”Ğ¢ĞµĞ·Ğ¸ÑÑ‹â€”</h2>

<p><em>ĞŸĞµÑ€Ğ¼ÑƒÑ‚Ğ¾ÑĞ´Ñ€Ğ¾Ğ¼</em> \(P_{n-1}\) Ğ½Ğ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ½Ğ¸Ğº Ğ² \(\{(x_1, \ldots, x_n) \in \mathbb{R}^{n} ~\vert~ \sum x_i = n(n-1)/2\} \cong \mathbb{R}^{n-1}\), Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ°Ğº</p>
<ul>
  <li>Ğ²Ñ‹Ğ¿ÑƒĞºĞ»Ğ°Ñ Ğ¾Ğ±Ğ¾Ğ»Ğ¾Ñ‡ĞºĞ° Ñ‚Ğ¾Ñ‡ĞµĞº, Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼Ñ‹Ñ… Ğ¸Ğ· \((0,1,\ldots,n-1)\) Ğ²ÑĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿ĞµÑ€ĞµÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°Ğ¼Ğ¸ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚;</li>
  <li>Ğ¸Ğ»Ğ¸ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ½Ğ¸Ğº ĞÑŒÑÑ‚Ğ¾Ğ½Ğ° Ğ²Ğ°Ğ½Ğ´ĞµÑ€Ğ¼Ğ¾Ğ½Ğ´Ğ¾Ğ²ÑĞºĞ¾Ğ³Ğ¾ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ½Ñ‚Ğ° \(\det (x_i^{j-1})_{i,j=1}^n\);</li>
  <li>Ğ¸Ğ»Ğ¸ ÑÑƒĞ¼Ğ¼Ğ° ĞœĞ¸Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ³Ğ¾ Ñ€Ñ‘Ğ±ĞµÑ€ ÑĞ¸Ğ¼Ğ¿Ğ»ĞµĞºÑĞ° \(\{(x_1, \ldots, x_n) \in \mathbb{R}^{n} ~\vert~ x_i \ge 0, \sum x_i = 1\}\);</li>
  <li>Ğ¸Ğ»Ğ¸ ÑÑ‡ĞµĞ¹ĞºĞ° Ğ’Ğ¾Ñ€Ğ¾Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµÑˆÑ‘Ñ‚ĞºĞ¸ \(A_{n-1}^*\) (ÑĞ¼. Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸).</li>
</ul>

<p><img src="/mipt2023systolic/images/amanha.jpg" alt="Ğ¡Ğ¸ÑÑ‚Ğ¾Ğ»Ñ‹ Ğ¸ Ğ´Ğ¸Ğ°ÑÑ‚Ğ¾Ğ»Ñ‹" title="Ğ¤Ğ¾Ñ‚Ğ¾: Ğ. Ğ‘Ğ°Ğ»Ğ¸Ñ†ĞºĞ¸Ğ¹" /></p>

<blockquote>
  <p><strong>Ğ¢ĞµĞ¾Ñ€ĞµĞ¼Ğ°.</strong> \((n-1)\)-Ğ¼ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ¾Ğ±ÑŠÑ‘Ğ¼ \(P_{n-1}\) Ñ€Ğ°Ğ²ĞµĞ½ \(n^{n-3/2}\).</p>
</blockquote>

<p><em>ĞĞ°Ğ±Ñ€Ğ¾ÑĞ¾Ğº Ğ´Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ°.</em>
ĞŸĞµÑ€Ğ¼ÑƒÑ‚Ğ¾ÑĞ´Ñ€ ÑĞ²Ğ»ÑĞµÑ‚ÑÑ <em>Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ Ğ·Ğ¾Ğ½Ğ¾Ñ‚Ğ¾Ğ¿Ğ¾Ğ¼</em>, Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ Ğ¾Ğ½ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ¸Ğ¼ Ğ² Ğ²Ğ¸Ğ´Ğµ ÑÑƒĞ¼Ğ¼Ñ‹ ĞœĞ¸Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ³Ğ¾
\[
Z_G = \sum\limits_{(i,j) \in E(G)} [e_i, e_j],
\]
Ğ³Ğ´Ğµ \(G\) â€” ĞºĞ»Ğ¸ĞºĞ° Ğ½Ğ° \(n\) Ğ²ĞµÑ€ÑˆĞ¸Ğ½Ğ°Ñ…. Ğ—Ğ¾Ğ½Ğ¾Ñ‚Ğ¾Ğ¿ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°Ğ·Ñ€ĞµĞ·Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ĞµĞ¿Ğ¸Ğ¿ĞµĞ´Ñ‹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ÑÑÑ‚ ÑĞ¾Ğ±Ğ¾Ğ¹ ÑÑƒĞ¼Ğ¼Ñ‹ ĞœĞ¸Ğ½ĞºĞ¾Ğ²ÑĞºĞ¾Ğ³Ğ¾ \((n-1)\) Ñ€Ñ‘Ğ±ĞµÑ€, Ğ½Ğµ Ğ»ĞµĞ¶Ğ°Ñ‰Ğ¸Ñ… Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ³Ğ¸Ğ¿ĞµÑ€Ğ¿Ğ»Ğ¾ÑĞºĞ¾ÑÑ‚Ğ¸. Ğ’ Ğ½Ğ°ÑˆĞµĞ¼ ÑĞ»ÑƒÑ‡Ğ°Ğµ Ğ²ÑĞµ Ğ¾Ğ½Ğ¸ Ğ¸Ğ¼ĞµÑÑ‚ Ğ¾Ğ±ÑŠÑ‘Ğ¼ \(\sqrt{n}\). ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ĞµĞ¿Ğ¸Ğ¿ĞµĞ´Ñ‹ Ñ€Ğ°Ğ·Ğ±Ğ¸ĞµĞ½Ğ¸Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ·Ğ¾Ğ½Ğ¾Ñ‚Ğ¾Ğ¿Ğ° Ğ¾Ñ‚Ğ¾Ğ¶Ğ´ĞµÑÑ‚Ğ²Ğ»ÑÑÑ‚ÑÑ Ñ Ğ¾ÑÑ‚Ğ¾Ğ²Ğ½Ñ‹Ğ¼Ğ¸ Ğ´ĞµÑ€ĞµĞ²ÑŒÑĞ¼Ğ¸ Ğ² \(G\), Ğ° Ğ² ĞºĞ»Ğ¸ĞºĞµ Ğ¸Ñ… \(n^{n-2}\), Ñ‡Ñ‚Ğ¾ Ğ»ĞµĞ³ĞºĞ¾ Ğ²Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ¸Ğ· Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ Ñ‚ĞµĞ¾Ñ€ĞµĞ¼Ñ‹ ĞšĞ¸Ñ€Ñ…Ğ³Ğ¾Ñ„Ğ°.
\(\square\)</p>

<h2 id="cÑÑ‹Ğ»ĞºĞ¸">â€”CÑÑ‹Ğ»ĞºĞ¸â€”</h2>
<ul>
  <li>A. Postnikov, <a href="https://academic.oup.com/imrn/article-pdf/2009/6/1026/18937162/rnn153.pdf">Permutohedra, associahedra, and beyond</a>. <em>International Mathematics Research Notices</em> (2009).</li>
  <li>Ğ. ĞĞ¹Ğ·ĞµĞ½Ğ±ĞµÑ€Ğ³, <a href="https://www.mccme.ru/dubna/2018/notes/ayzenberg-notes.pdf">ĞŸÑ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ÑÑ‚Ğ²Ğ° Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ† Ğ¸ Ğ²Ñ‹Ğ¿ÑƒĞºĞ»Ñ‹Ğµ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ½Ğ¸ĞºĞ¸</a>.</li>
</ul>

<p>é¢„è®¡éš¾åº¦ï¼šCF Div2-</p>

<p><a href="https://github.com/wu-kan/SYSU-Collegiate-Programming-Contest-2020--Online">é¢˜ç›®æ•°æ®&amp;ç°åœºæ¦œå•</a></p>

<h2 id="welcome-to-sysu">Welcome to SYSU</h2>

<p>Sun Yat-sen University, originally known as National Guangdong University, was founded in 1924 by Dr. Sun Yat-sen (also called Sun Zhongshan), a great democratic revolutionary leader of the 20th century. The University is located in Guangdong Province, an area neighboring Hong Kong and Macao, which is at the forefront of Chinaâ€™s reform and opening up.</p>

<p><img src="https://i.loli.net/2020/11/14/cPQZhbFO3xgnYUd.jpg" alt="welcome" /></p>

<p>Being one of the leading universities in the Peopleâ€™s Republic of China, Sun Yat-sen University is a comprehensive multi-disciplinary university, including the humanities, social sciences, natural sciences, technical sciences, medical sciences, pharmacology, and management science. At present, Sun Yat-sen University covers a total area of 6.17 square kilometers and has 4 campuses: Guangzhou South Campus, Guangzhou North Campus, Guangzhou East Campus, and Zhuhai Campus.</p>

<h3 id="input">Input</h3>

<p>The input contains a positive integers n.</p>

<p>$1\le n\le 12$</p>

<h3 id="output">output</h3>

<p>You should output the lexicographically N-th string with the same letters(2*<code class="language-plaintext highlighter-rouge">S</code>+1*<code class="language-plaintext highlighter-rouge">Y</code>+1*<code class="language-plaintext highlighter-rouge">U</code>) as <code class="language-plaintext highlighter-rouge">SYSU</code>.</p>

<h3 id="sample-input-1">Sample Input 1</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
</code></pre></div></div>

<h3 id="sample-output-1">Sample Output 1</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SSUY
</code></pre></div></div>

<h3 id="sample-input-2">Sample Input 2</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5
</code></pre></div></div>

<h3 id="sample-output-2">Sample Output 2</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SYSU
</code></pre></div></div>

<h3 id="source">Source</h3>

<p>å´å</p>

<h3 id="solution">Solution</h3>

<p>é¢˜ç›®å¤§æ„ï¼šè¾“å‡ºä¸ <code class="language-plaintext highlighter-rouge">SYSU</code> å­—æ¯ç›¸åŒçš„å­—å…¸åºç¬¬ $n$ å°çš„ä¸²ã€‚</p>

<p>ç†Ÿæ‚‰ STL çš„åŒå­¦å¯ä»¥ç›´æ¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">next_permutation</code> è§£å†³.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">string</span> <span class="n">s</span><span class="p">(</span><span class="s">"SYSU"</span><span class="p">);</span>
	<span class="n">sort</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span> <span class="o">--</span><span class="n">n</span><span class="p">;)</span>
		<span class="n">next_permutation</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä¸ç†Ÿçš„åŒå­¦ç›´æ¥æ‰‹ç®—ç„¶åæ‰“è¡¨ä¹Ÿæ˜¯å¯ä»¥çš„å•¦~</p>

<p><img src="https://i.loli.net/2020/11/14/fRLtgH9M13ZWxId.png" alt="~~ç¬¬ä¸€é¢˜ã®ç¥~~" /></p>

<p><del>æ¬¢è¿æŠ¥è€ƒä¸­å±±å¤§å­¦ï¼</del></p>

<h2 id="formula">Formula</h2>

<p>This formula is written as an equation about the length of edges A, B and C, which is usually called Pythagorean law.</p>

<p>$A^2 + B^2 = C^2$</p>

<p>Where $C$ is the length of the slanted side and $A$ and $B$ are the lengths of the other two sides.</p>

<p>Given $n$, you need to compute right triangles with side lengths $A$, $B$ and $C$ satisfying inequality $1 \le A \le B \le C \le n$.</p>

<h3 id="input-1">Input</h3>

<p>The first line of input contains an integer $n~(1\leq n\leq 10000)$.</p>

<h3 id="output-1">Output</h3>

<p>The first line of input contains an integer donating the answer.</p>

<h3 id="sample-input">Sample Input</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5
</code></pre></div></div>

<h3 id="sample-output">Sample Output</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
</code></pre></div></div>

<h3 id="note">Note</h3>

<p>3, 4, 5</p>

<h3 id="source-1">Source</h3>

<p>èŒƒä¿­è±ª</p>

<h3 id="solution-1">Solution</h3>

<p>æš´åŠ›æšä¸¾ aï¼Œb å³å¯ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">a</span><span class="p">)</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">b</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">double</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="p">);</span>
			<span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cc</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">==</span> <span class="n">cc</span><span class="p">)</span>
				<span class="o">++</span><span class="n">ans</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><del>å¦‚æœæ‹…å¿ƒæ—¶é—´è¢«å¡çš„è¯æ‰“è¡¨ä¹Ÿæ˜¯æ¯«æ— é—®é¢˜çš„ã€‚</del></p>

<h2 id="island">Island</h2>

<p>A tour group is trapped on an island. The island can be regarded as a matrix of equal side length.</p>

<p>Each grid is either an obstacle (character <code class="language-plaintext highlighter-rouge">#</code>), a tourist (character <code class="language-plaintext highlighter-rouge">O</code>), or an open space (character <code class="language-plaintext highlighter-rouge">.</code>), visitors can walk up, down, left, right(to neighboring grid), but canâ€™t walk over obstacles.</p>

<p>Ask how many tourists can never get out of the island.</p>

<h3 id="input-2">Input</h3>

<p>First line of the input is an integer $T$($1\le T \le 10$) indicating the number of test cases.</p>

<p>For each case, the first line contains an integer $n$ ($1\le n \le 50$) indicating the side length of island, each of the following $n$ lines contains a string with exact n charactors(obstacle <code class="language-plaintext highlighter-rouge">#</code>, tourist <code class="language-plaintext highlighter-rouge">O</code> or space <code class="language-plaintext highlighter-rouge">.</code>).</p>

<h3 id="output-2">Output</h3>

<p>For each case output one integer per line, the number of tourist(s) cannot get out of the island.</p>

<h3 id="sample-input-1">Sample Input</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
4
O.##
.#O#
<span class="c">#O.#</span>
.###
</code></pre></div></div>

<h3 id="sample-output-1">Sample Output</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
</code></pre></div></div>

<h3 id="source-2">Source</h3>

<p>æ¢èµ›æ³¢</p>

<h3 id="solution-2">Solution</h3>

<p>é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ª $n\times n$ çŸ©é˜µï¼Œæ¯ä¸ªç‚¹è¦ä¹ˆæ˜¯æ¸¸å®¢ï¼Œè¦ä¹ˆæ˜¯ç©ºåœ°ï¼Œè¦ä¹ˆæ˜¯éšœç¢ç‰©ï¼Œæ¯ä¸ªäººæ¯æ¬¡å¯ä»¥æœä¸Šä¸‹å·¦å³ä»»ä¸€æ–¹å‘èµ°ä¸€æ ¼ï¼Œé—®æœ‰å¤šå°‘äººæœ€ç»ˆå¯ä»¥èµ°å‡ºçŸ©é˜µã€‚</p>

<p>æš´åŠ›çš„åšæ³•æ˜¯ï¼Œæ¯ä¸ªæ¸¸å®¢åˆ†åˆ«ä»¥ä»–åˆå§‹ä½ç½®ä¸ºèµ·ç‚¹ï¼Œæœç´¢ï¼ˆBFS/DFSï¼‰å‡ºåˆ°è¾¾çŸ©é˜µä¹‹å¤–çš„è·¯å¾„ï¼Œæ—¶é—´å¤æ‚åº¦ $O(Tn^4)$</p>

<p>å¯ä»¥å‘ç°å¦‚æœæŸä¸ªæ ¼å­å¯ä»¥æœ€ç»ˆèµ°å‡ºçŸ©é˜µï¼Œé‚£ä¹ˆæ‰€æœ‰è·¯è¿‡è¯¥æ ¼å­çš„äººéƒ½å¯ä»¥æœ€ç»ˆèµ°å‡ºçŸ©é˜µã€‚</p>

<p>ä¸Šè¿°æœç´¢è¿‡ç¨‹ä¸€æ—¦èµ°åˆ°<strong>æœ€ç»ˆå¯ä»¥é€ƒå‡º</strong>çš„æ ¼å­ï¼Œå°±å¯ä»¥ç«‹å³è¿”å›ã€‚æ¯ä¸ªæ ¼å­åªä¼šè¢«éå†ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ $O(Tn^2)$ã€‚</p>

<p>åŒæ ·çš„æ—¶é—´å¤æ‚åº¦ï¼Œä¹Ÿå¯ä»¥ä»çŸ©é˜µçš„ééšœç¢è¾¹ç•Œå¼€å§‹å‘å†…æœç´¢ï¼Œèƒ½åˆ°è¾¾çš„æ¸¸å®¢æ ¼å­è‚¯å®šå¯ä»¥æ²¿ç€ç›¸åçš„è·¯é€ƒå‡ºå»ã€‚</p>

<!--  -->

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">dir</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}};</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="n">maxn</span><span class="p">][</span><span class="n">maxn</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">maxn</span><span class="p">][</span><span class="n">maxn</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">vis</span><span class="p">));</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">j</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">'#'</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
					<span class="n">q</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
		<span class="p">{</span>
			<span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
			<span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">first</span> <span class="o">+</span> <span class="n">dir</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">;</span>
				<span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">second</span> <span class="o">+</span> <span class="n">dir</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="o">||</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">||</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'#'</span><span class="p">)</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="n">vis</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
				<span class="n">q</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'O'</span><span class="p">)</span>
					<span class="n">ans</span><span class="o">++</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<!--  -->

<h2 id="liz-and-the-blue-bird">Liz and the Blue Bird</h2>

<p>After a long thought, Liz made a tough decision. When the girl came back home from picking raspberries with delight. Liz said goodbye to the girl with smile. A basket of raspberries dropped, scattering on the floor. â€œYou are ought to be free and use your lightsome wings to fly to everywhere you want.â€ â€œWhy? I just want to stay with you forever. Only by your side can I taste the sweet of happiness.â€ â€œI am the cage that traps you. You have wings and vast sky to explore. I canâ€™t deprive you of your wings,â€ Liz opened the door, smiling mildly. â€œSo just leave here and fly high. Please let me watch your beautiful figure go away,â€ Liz held out her hand, â€œThatâ€™s the way I convey my feelings.â€ She paused and took a deep breath â€œI love you.â€ The girl sobbed, stepped slowly towards door. She looked back, with love, with unwillingness, and turned into a blue bird, flying away.</p>

<p><a href="https://twitter.com/Lyytoaoitori/status/1073908097414946817"><img src="https://i.loli.net/2020/11/11/WCUM8ndNwVtAl6h.jpg" alt="bluebird" /></a></p>

<p>After the blue bird flew away, Liz still missed her very much. Worrying that she and other small animals might be caught in a storm again, Liz decided to transplant trees in the woods to cover as much area as possible. There were $n$ trees in the woods, and each tree $T_i$ can be represented as a closed interval $[a_i,b_i]$. Liz wanted to find a solution so that all intervals covered $[0,10000]$, and the displacement of the interval with the largest displacement was minimized. Specifically, suppose $T_i$ was moved to $[a_i+c_i, b_i+c_i]$, and Liz wanted to minimize $\max_i\lvert c_i \rvert$.</p>

<h3 id="input-3">Input</h3>

<p>First line of the input is an integer $n$ indicating the number of trees.</p>

<p>The following $n$ lines, each line contains 2 integers $a_i,b_i$.</p>

<p>$1&lt;n&lt;10000, 0\le a_i&lt;b_i\le 10000, \sum_{i=1}^n(b_i-a_i)\ge 10000$</p>

<h3 id="output-3">Output</h3>

<p>Output a real number that represents the answer.</p>

<p>If the answer is an integer, output the integer directly; otherwise, keep 1 decimal place.</p>

<p>If you still have any questions, you can refer to the sample output.</p>

<h3 id="sample-input-1-1">Sample Input 1</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
10 5010
4980 9980
</code></pre></div></div>

<h3 id="sample-output-1-1">Sample Output 1</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>20
</code></pre></div></div>

<h3 id="sample-input-2-1">Sample Input 2</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4
0 4000
3000 5000
5001 8000
7000 10000
</code></pre></div></div>

<h3 id="sample-output-2-1">Sample Output 2</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.5
</code></pre></div></div>

<h3 id="note-1">Note</h3>

<p>The answer must be a semi-integer, that is, twice the number must be an integer.</p>

<h3 id="source-3">Source</h3>

<p>å´å</p>

<h3 id="solution-3">Solution</h3>

<p>äºŒåˆ†ç­”æ¡ˆ $\Delta$ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦æœ‰ç§»åŠ¨æ–¹æ¡ˆä½¿å¾—æ‰€æœ‰åŒºé—´çš„ç§»åŠ¨é‡éƒ½ä¸è¶…è¿‡ $\Delta$ã€‚ä»¤ $[S,T]=[0,10000]$ è¡¨ç¤ºæˆ‘ä»¬è¦è¦†ç›–çš„åŒºåŸŸï¼Œå½“ $\Delta$ å·²ç»ç»™å®šæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹è´ªå¿ƒç®—æ³•ã€‚</p>

<ul>
  <li>åˆå§‹åŒ– $A=S$ã€‚ï¼ˆæ³¨ï¼šç®—æ³•è¿è¡Œè¿‡ç¨‹ä¸­ä¿è¯ $[S,A]$ å·²ç»è¢«è¦†ç›–ï¼‰</li>
  <li>While $A&lt;T$
    <ol>
      <li>å‡å®šå½“å‰æœªè¢«ä½¿ç”¨è¿‡çš„åŒºé—´ä¸º $D_1,\dots,D_K$ã€‚</li>
      <li>åœ¨è¿™äº›åŒºé—´ä¸­æ‰¾ä¸€ä¸ªåœ¨ $[-\Delta,+ \Delta]$ è¿™ä¸ªç§»åŠ¨é‡å†…èƒ½ cover ç‚¹ A çš„åŒºé—´å‡ºæ¥ã€‚å¦‚æœæœ‰å¤šä¸ªè¿™æ ·çš„åŒºé—´ï¼Œåˆ™é€‰å…¶ä¸­å³ç«¯ç‚¹æœ€å°çš„é‚£ä¸€ä¸ªã€‚</li>
      <li>ä¸å¦¨å‡å®š $D_1$ æ˜¯æ‰€é€‰çš„åŒºé—´ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ $D_1$ æ¥è¦†ç›– $A$ã€‚å…·ä½“åšæ³•ä¸ºï¼šç§»åŠ¨ $D_1$ ä½¿å¾—åœ¨ä¿è¯ $A$ ç‚¹è¢«å®ƒè¦†ç›–çš„å‰æä¸‹ç§»åŠ¨åçš„ä½ç½®è¶Šé å³è¶Šå¥½ï¼</li>
      <li>æŠŠåŒºé—´ $D_1$ æ ‡è®°ä¸ºå·²ä½¿ç”¨è¿‡å¹¶ä¸”æ›´æ–° $A$ ä¸º $D_1$ ç§»åŠ¨åçš„å³åæ ‡ã€‚</li>
    </ol>
  </li>
</ul>

<p>ç®—æ³•æ­£ç¡®æ€§è¯æ˜æ€è·¯å¦‚ä¸‹ã€‚å‡å®šåœ¨æŸä¸ªçŠ¶æ€ä¸‹å­˜åœ¨å¯¹æœªä½¿ç”¨åŒºé—´çš„ä¸€ä¸ªæ”¾æ³•ï¼ˆè®°ä½œ $\text{SOL}$ï¼‰å»è¦†ç›– $[A,T]$ è¿™ä¸ªåŒºåŸŸï¼Œé‚£ä¹ˆæŒ‰ä¸Šè¿°è´ªå¿ƒæ ‡å‡†è¿è¡Œä¸‹å»ä¹Ÿä¸€å®šèƒ½æ‰¾åˆ°ä¸€ä¸ªæ”¾æ³•å»è¦†ç›– $[A,T]$ è¿™ä¸ªåŒºåŸŸã€‚ä½¿ç”¨å½’çº³æ³•è¯æ˜è¿™ä¸ªç»“è®ºã€‚æ˜¾ç„¶ä¸Šè¿°å‘½é¢˜å¯¹ $K=1$ æ˜¯æˆç«‹çš„ï¼Œä¸‹é¢è€ƒè™‘ $K&gt;1$çš„æƒ…å†µã€‚</p>

<p>å‡å®š $D_1$ æ˜¯æ ¹æ®è´ªå¿ƒç®—æ³•é€‰æ‹©çš„é‚£ä¸ªåŒºé—´ã€‚å¦‚æœ $\text{SOL}$ ä¸­ $D_1$ è¢«æ”¾ç½®çš„ä½ç½®èƒ½ cover ä½ $A$ã€‚é‚£ä¹ˆå¾ˆæ˜æ˜¾ç»“è®ºæ˜¯æ­£ç¡®çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å‡å®š $\text{SOL}$ ç”¨äº†å¦ä¸€ä¸ªåŒºé—´ï¼Œä¾‹å¦‚ $D_2$ï¼Œæ¥ cover ç‚¹ $A$ã€‚ä¸å¦¨å‡å®š $D_2$ åœ¨ $\text{SOL}$ ä¸­è¢«ç§»åŠ¨åˆ°äº†å°½é‡é å³çš„ä½ç½®ã€‚å¦åˆ™å¯ä»¥è°ƒæ•´ SOLã€‚å‡è®¾ $D_2$ åœ¨ $\text{SOL}$ ä¸­ç§»åŠ¨åçš„å³åæ ‡ä¸º $Aâ€™$ã€‚åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºï¼š</p>

<ol>
  <li>$D_1$ ç§»åŠ¨åä¸èƒ½å¤Ÿè¦†ç›– $Aâ€™$ã€‚é‚£ä¹ˆ $D_1$ åœ¨ $\text{SOL}$ ä¸­å®é™…ä¸Šæ˜¯æ²¡æœ‰ç”¨çš„ï¼å› æ­¤æˆ‘ä»¬å…ˆç”¨ $D_1$ å»è¦†ç›– A å¹¶ä¸ä¼šé”™å¤±ä¸€ä¸ªè§£ã€‚</li>
  <li>$D_1$ ç§»åŠ¨åèƒ½å¤Ÿè¦†ç›– $Aâ€™$ã€‚æ­¤æ—¶ï¼Œé€šè¿‡å½’çº³å‡è®¾ï¼Œæˆ‘ä»¬çŸ¥é“å­˜åœ¨ä¸€ä¸ªè§£ $\text{SOLâ€™}$ã€‚ä½¿å¾—åœ¨ä¸‹ä¸€æ­¥ä¸­æˆ‘ä»¬é€‰å®š $D_1$ å»è¦†ç›– $Aâ€™$ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°ï¼ˆè¿™é‡Œè¯·è¯»è€…è‡ªå·±ç”»å›¾éªŒè¯ï¼‰ï¼Œé€šè¿‡è°ƒæ•´ $\text{SOLâ€™}$ â€”â€”å°† $D_1$ å·¦ç§»è€Œå°† $D_2$ å³ç§»â€”â€”èƒ½ä½¿å¾—è¿™ä¸¤ä¸ªåŒºé—´ä»ç„¶è¦†ç›–ä½ $[A,Aâ€™]$ çš„å‰æä¸‹ï¼Œ$D_1$ è¦†ç›–äº†ç‚¹ $A$ã€‚</li>
</ol>

<p>æ ¹æ®ä»¥ä¸Šä¸¤ç§æƒ…å†µæˆ‘ä»¬çŸ¥é“ï¼Œæœ‰è§£çš„æƒ…å†µä¸‹æˆ‘ä»¬çš„è´ªå¿ƒæ ‡å‡†ä¹Ÿèƒ½æ‰¾åˆ°ä¸€ä¸ªè§£ã€‚ç®—æ³•çš„æ­£ç¡®æ€§å¾—è¯ã€‚</p>

<p>æ ¹æ®ç®—æ³•æµç¨‹ï¼Œç»™å®š $\Delta$ï¼Œå¾ˆå®¹æ˜“åœ¨ $O(n^2)$ çš„æ—¶é—´å†…å®ç°åˆ¤å®šï¼Œä¸è¿‡è¿™ä¼šè¶…æ—¶ã€‚åˆ©ç”¨å †è¿™ä¸€æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç®—æ³•çš„æ•ˆç‡æå‡åˆ° $O(n\log n)$ã€‚å°†æœªä½¿ç”¨çš„åŒºé—´åˆ†ä¸ºä¸‰ç±»ï¼š</p>

<ul>
  <li>Bornï¼šå®ƒçš„å·¦ç«¯ç‚¹ $&gt;A+\Delta$ã€‚</li>
  <li>Activeï¼šå®ƒä¸åŒºé—´ $[A-\Delta,A+ \Delta]$ æœ‰ç›¸äº¤ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡ç§»åŠ¨åå®ƒèƒ½è¦†ç›– A ç‚¹ã€‚</li>
  <li>Deadï¼šå®ƒçš„å³æ–­ç‚¹ $&lt;A-\Delta$ã€‚</li>
</ul>

<p>ç”±äºç®—æ³•è¿‡ç¨‹ä¸­ A æ˜¯ä¸æ–­å˜å¤§çš„ã€‚æ‰€ä»¥ Dead çš„åŒºé—´æ°¸è¿œæ˜¯ Dead çš„ã€‚ä¸ºå®ç°æˆ‘ä»¬çš„ç®—æ³•ï¼Œåªéœ€ä¸€ä¸ªæœ€å°å †æ¥ç»´æŠ¤ Active çš„åŒºé—´ï¼ŒKey ä¸ºåŒºé—´çš„å³ç«¯ç‚¹ã€‚</p>

<p>å‚è€ƒï¼šDanny Z. Chen Yan Gu Jian Li Haitao Wang, Algorithms on Minimizing the Maximum Sensor Movement for Barrier Coverage of a Linear Domain</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e4</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mf">1e4</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">EPS</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">;</span>
<span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">ok</span><span class="p">(</span><span class="kt">double</span> <span class="n">delta</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">double</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">A</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="o">-</span> <span class="n">EPS</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">&lt;=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">delta</span> <span class="o">+</span> <span class="n">EPS</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
		<span class="kt">int</span> <span class="n">updated</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span> <span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">updated</span><span class="p">;</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">())</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">second</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">first</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">second</span><span class="p">,</span>
				<span class="n">A</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">delta</span> <span class="o">+</span> <span class="n">EPS</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">A</span> <span class="o">&gt;</span> <span class="n">l</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span>
					<span class="n">A</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">delta</span><span class="p">;</span>
				<span class="k">else</span>
					<span class="n">A</span> <span class="o">+=</span> <span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">;</span>
				<span class="n">updated</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">updated</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">bs</span><span class="p">(</span><span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">e</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ok</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">?</span> <span class="n">bs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">:</span> <span class="n">bs</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span>
	<span class="n">sort</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="n">n</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">bs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">ans</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ans</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">".5"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å®Œæ•´çš„èƒŒæ™¯æ•…äº‹å¯è§ <a href="https://www.bilibili.com/read/cv7276984">https://www.bilibili.com/read/cv7276984</a> ï¼Œæ­¤å¤„å·²è·å¾—åŸä½œè€…çš„ä½¿ç”¨è®¸å¯ã€‚</p>

<p><img src="https://i.loli.net/2020/11/11/wQPsCh9TSRqfaVH.png" alt="ä½¿ç”¨è®¸å¯" /></p>

<p><del>å¼ºæ¨ä¸€æ³¢åˆ©å…¹ä¸é’é¸Ÿï¼Œå®˜æ–¹åœ¨å›½å†…å¼€é€šäº†<a href="https://weibo.com/u/7479642080">å¾®åš</a>ï¼Œä¸è¿‡æ„Ÿè§‰ç¦»ä¸Šæ˜ è¿˜é¥é¥æ— æœŸçš„æ ·å­â€¦</del></p>

<h2 id="berth-allocation">Berth Allocation</h2>

<p>In a container terminal, the bottleneck of the traffic is often at the quay. Therefore, the terminal operator has to allocate a limited number of berths of the quay to vessels in an efficient way.</p>

<p><img src="https://i.loli.net/2020/11/11/EpjJgw6evXlaMsd.png" alt="berth" /></p>

<p>As illustrate in Figure above (An illustrated example, with a quay of $n=5$ berths, $m=7$ vessels, where two vessels are waiting outside the quay), consider a container terminal of $n$ berths and $m$ vessels arrived, where each vessel $i$ (for $i=1,2,\dots,m$) requires a berth to load and unload containers, and the handling time is $t_{i,j}$ minutes if berth $j$ (for $j=1, 2, \dots, n$) is allocated to vessel $i$. For each vessel $i=1,2,\dots,m$, the terminal manager, Brother D, needs to decide on the berth, denoted by $b_i\in\lbrace 1,2,\dots,n\rbrace $, as well on the starting time of berthing, denoted by $s_i\ge 0$. It must be satisfied that no two vessels are allowed to occupy the same berth simultaneously, i.e., for any two different vessels i and j, if $b_i=b_j$, then either $s_i+t_{i,b_i}\le s_j$ or $s_j+t_{j,b_j}\le s_i$ must be satisfied. Your task is to help Brother D to minimize the total completion time of the vessels, i.e., to minimize $\sum_{i=1}^m(s_i+t_{i,b_i})$.</p>

<h3 id="input-4">Input</h3>

<p>First line of the input is an integer $T$ indicating the number of test cases. For each case, the first line contains two integers $n$ and $m$ (for $1\le n\le 50, 1\le m\le 200$). Each of the following $m$ lines contains $n$ positive integers representing vessel iâ€™s handling times $t_{i,1}, t_{i,2}, \dots, t_{i,n} (t_{i,j} \le 1000)$.</p>

<h3 id="output-4">Output</h3>

<p>For each case, output one integer, the minimum total weighted completion time of all the vessels.</p>

<h3 id="sample-input-2">Sample Input</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
5 7
1 2 3 4 5
2 1 3 4 5
2 3 1 4 5
2 3 4 1 5
2 3 4 5 1
2 2 2 2 2
2 2 2 2 2
</code></pre></div></div>

<h3 id="sample-output-2">Sample Output</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>11
</code></pre></div></div>

<h3 id="source-4">Source</h3>

<p>å´å</p>

<h3 id="solution-4">Solution</h3>

<p><strong>èœé¸¡å‘½é¢˜äººèƒŒé”…äº†â€¦PDF Input ç»“å°¾å¤„åº”è¯¥æ˜¯ $t_{i,n}$ ä¸æ˜¯ $t_{i,m}$ï¼Œæ­¤é—®é¢˜é—´æ¥å¯¼è‡´æˆ‘æ ¡ä¸€é˜Ÿæ²¡æœ‰ AKâ€¦</strong></p>

<p>é¢˜ç›®å¤§æ„ï¼š$n$ ä¸ªå¸è´§ç‚¹ï¼Œ$m$ æ¡èˆ¹ï¼Œèˆ¹ $i$ åœ¨å¸è´§ç‚¹ $j$ å¸è´§çš„æ—¶é—´æ˜¯ $t_{i,j}$ï¼ŒåŒä¸€æ—¶åˆ»ä¸€ä¸ªå¸è´§ç‚¹åªèƒ½æœ‰ä¸€æ¡èˆ¹ï¼Œç°åœ¨æ¯æ¡èˆ¹éƒ½è¦å¸è´§ï¼Œè¦æœ€å°åŒ– $\sum_{i=1}^m\left(s_i+t_{i,b_i}\right)$ï¼Œå…¶ä¸­èˆ¹ $i$ åœ¨ $s_i$ æ—¶åˆ»å¼€å§‹åœ¨ $b_i$ å¸è´§ç‚¹å¸è´§ã€‚</p>

<p>å®¹æ˜“çœ‹å‡ºï¼Œ$s_i$ ä¸€å®šæ˜¯è‹¥å¹²ä¸ª $t_{a,b}$ çš„å’Œã€‚å› æ­¤ç›´æ¥è€ƒè™‘æ¯ä¸ª $t_{a,b}$ å¯¹ç­”æ¡ˆçš„è´¡çŒ®ï¼Œ<strong>ä¸éš¾</strong><del>å£å¯å£å¯</del>æƒ³å‡ºä¸€ä¸ªè´¹ç”¨æµæ¨¡å‹ï¼š</p>

<ol>
  <li>å»ºç«‹è¶…çº§æºç‚¹ $S$ ã€è¶…çº§æ±‡ç‚¹ $T$</li>
  <li>å¯¹äºæ¯æ¡èˆ¹å»ºç‚¹ $P_i$ï¼Œå¹¶è¿è¾¹ $P_i\to T$ï¼Œè¾¹é•¿ $0$ å®¹é‡ $1$</li>
  <li>å¯¹äºæ¯ä¸ªå¸è´§ç‚¹å»ºç‚¹ $Q_j$ï¼Œå¹¶è¿è¾¹ $S\to Q_j$ï¼Œè¾¹é•¿ $0$ å®¹é‡ $\infty$</li>
  <li>å¯¹äºæ¯ä¸ªå¸è´§ç‚¹ $j$ å’Œå¯¹ç­”æ¡ˆçš„è´¡çŒ®æ•° $k$ å»ºç‚¹ $R_{j,k}$
    <ul>
      <li>è¿è¾¹ $Q_j\to R_{j,k}$ï¼Œè¾¹é•¿ $0$ å®¹é‡ $1$</li>
      <li>å¯¹äºæ¯æ¡èˆ¹ $i$ è¿è¾¹ $R_{j,k}\to P_i$ï¼Œè¾¹é•¿ $k\times t_{i,j}$ å®¹é‡ $1$</li>
    </ul>
  </li>
</ol>

<p>å¦‚æœä½ å¯¹è¿™ä¸ªå»ºå›¾æ–¹å¼ä»ç„¶æœ‰ç–‘é—®ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªç®€å•çš„æ ·ä¾‹ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
1 2
7
10
</code></pre></div></div>

<p>å¯¹åº”çš„å»ºå›¾æ–¹å¼å¦‚ä¸‹ï¼ˆå›¾ä¸­è¾¹ä¸Šçš„æ•°æ®æ˜¯â€œè¾¹é•¿ï¼Œå®¹é‡â€çš„æ ¼å¼ï¼Œè´¹ç”¨ = è¾¹é•¿ * æµé‡ï¼‰ï¼Œå®¹æ˜“çœ‹å‡ºè¿™å¼ å›¾çš„æœ€å°è´¹ç”¨æ˜¯ 24ï¼Œä¹Ÿæ˜¯æœ€åçš„ç­”æ¡ˆã€‚</p>

<pre><code class="language-mermaid">flowchart LR
S--"0,#infin;"--&gt;Q1
Q1--0,1--&gt;R1,1
Q1--0,1--&gt;R1,2
R1,1-.7,1.-&gt;P1
R1,1--10,1--&gt;P2
R1,2--14,1--&gt;P1
R1,2-.20,1.-&gt;P2
P1--0,1--&gt;T
P2--0,1--&gt;T
</code></pre>

<p>ç”±äº $\lvert R\rvert \le 50\times 200=10000$ï¼Œä¸Šè¿°æ–¹æ¡ˆæ—¶é—´å¤æ‚åº¦éš¾ä»¥æ¥å—ã€‚äºæ˜¯è€ƒè™‘åœ¨è·‘è´¹ç”¨æµçš„æ—¶å€™åŠ¨æ€å»ºå›¾ï¼Œä¸€è¾¹å¢å¹¿ä¸€è¾¹æ‰© $R$ é›†åˆçš„ç‚¹ï¼Œç›´åˆ°æ±‡ç‚¹çš„æµé‡è¾¾åˆ° $n$ã€‚ç”±äºæ¯æ¬¡æ‰¾åˆ°çš„å¢å¹¿è·¯ä¸€å®šç¬¦åˆ $S\to Q\to R\to P\to T$ çš„å½¢å¼ï¼Œæ­¤æ—¶å¯¹äºè¿™æ¡è·¯ä¸Šçš„ $Q$ ç‚¹å°±å¯ä»¥æ‰©å¼ æ–°çš„ä¸€å±‚ $R$ ç‚¹ï¼Œä¸åœ¨å®Œæ•´å›¾ä¸Šè·‘è´¹ç”¨æµåœ¨æ•ˆæœä¸Šæ˜¯ç­‰ä»·çš„ã€‚</p>

<p>ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±å†™çš„æ ‡ç¨‹ï¼Œç”¨äº†<a href="https://wu-kan.cn/_posts/2019-02-02-%E5%9B%BE%E8%AE%BA/#primaldual-%E6%B1%82%E8%B4%B9%E7%94%A8%E6%B5%81">å•è·¯å¢å¹¿çš„ PD</a>ï¼Œæ¯” EK ç®—æ³•å¿«ä¸‰å€å·¦å³ï¼ˆ0.740sï¼š0.219sï¼‰ã€‚ç”±äºæœ¬é¢˜åŠ¨æ€æ‰©å›¾çš„ç‰¹æ€§ï¼Œå¯èƒ½ä¸å¤ªé€‚åˆå¤šè·¯å¢å¹¿çš„è´¹ç”¨æµç®—æ³•ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">INF</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">63</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">tim</span><span class="p">[</span><span class="n">M</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
<span class="k">struct</span> <span class="nc">Graph</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="nc">Vertex</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">o</span><span class="p">;</span>
	<span class="p">};</span>
	<span class="k">struct</span> <span class="nc">Edge</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">;</span>
		<span class="n">ll</span> <span class="n">len</span><span class="p">,</span> <span class="n">cap</span><span class="p">;</span>
	<span class="p">};</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Vertex</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">;</span>
	<span class="n">Graph</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">v</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">ed</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">v</span><span class="p">[</span><span class="n">ed</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="n">e</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">PrimalDual</span> <span class="o">:</span> <span class="n">Graph</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">flow</span><span class="p">,</span> <span class="n">cost</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">f</span><span class="p">;</span>
	<span class="n">PrimalDual</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">Graph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="n">Edge</span> <span class="n">ed</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Graph</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
		<span class="n">swap</span><span class="p">(</span><span class="n">ed</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">ed</span><span class="p">.</span><span class="n">second</span><span class="p">),</span> <span class="n">ed</span><span class="p">.</span><span class="n">cap</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ed</span><span class="p">.</span><span class="n">len</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">Graph</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">ask</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">now</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">INF</span><span class="p">),</span> <span class="n">h</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">flow</span> <span class="o">=</span> <span class="n">cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);;)</span>
		<span class="p">{</span>
			<span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">));</span> <span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">();)</span>
			<span class="p">{</span>
				<span class="n">ll</span> <span class="n">dis</span> <span class="o">=</span> <span class="o">-</span><span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">first</span><span class="p">;</span>
				<span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">second</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">)</span>
					<span class="k">continue</span><span class="p">;</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">to</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">to</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">second</span><span class="p">,</span>
						<span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">cap</span> <span class="o">&gt;</span> <span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">len</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="p">[</span><span class="n">to</span><span class="p">])</span>
					<span class="p">{</span>
						<span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">len</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="p">[</span><span class="n">to</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
						<span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">],</span> <span class="n">to</span><span class="p">));</span>
					<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">INF</span><span class="p">)</span>
				<span class="k">return</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span><span class="p">)</span>
					<span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
			<span class="n">ll</span> <span class="n">_f</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">s</span><span class="p">;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">first</span><span class="p">)</span>
				<span class="n">_f</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">_f</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">cap</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]]);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">s</span><span class="p">;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">first</span><span class="p">)</span>
				<span class="n">cost</span> <span class="o">+=</span> <span class="n">_f</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">len</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">_f</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">^</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">_f</span><span class="p">;</span>
			<span class="n">flow</span> <span class="o">+=</span> <span class="n">_f</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">s</span><span class="p">;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">first</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">u</span> <span class="o">&amp;&amp;</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">u</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
					<span class="o">++</span><span class="n">now</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
					<span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
					<span class="n">d</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">INF</span><span class="p">);</span>
					<span class="n">h</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
					<span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">Vertex</span><span class="p">());</span>
					<span class="n">add</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">});</span>
					<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
						<span class="n">add</span><span class="p">({</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">now</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">tim</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="mi">1</span><span class="p">});</span>
					<span class="n">f</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="mi">0</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">t</span><span class="p">);</span> <span class="n">t</span><span class="o">--</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
		<span class="n">PrimalDual</span> <span class="n">g</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">INF</span><span class="p">});</span>
			<span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="mi">2</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">});</span>
		<span class="p">}</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tim</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
				<span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">tim</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="mi">1</span><span class="p">});</span>
			<span class="p">}</span>
			<span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">});</span>
		<span class="p">}</span>
		<span class="n">g</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">cost</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><del><a href="https://blog.csdn.net/D5__J9">D å“¥</a>å¸¦å¸¦æˆ‘</del></p>
:ET